<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<title>NOIp 2016J3 - zsz12251665's Blog</title>
		<link rel="shortcut icon" href="/favicon.ico" />
	</head>
	<body class="matrix">
		<h2 align="center">NOIp 2016J3</h2>
		<time>2017-04-13 16:57 by zsz12251665</time>
		<h3>Problem</h3>
		<section class="btnfield">
			<a target="_blank" href="https://www.luogu.org/problemnew/show/P2058">Luogu</a>
			<a target="_blank" href="https://www.vijos.org/p/2011">Vijos</a>
		</section>
		<h3>Solution</h3>
		<section>
			<p>The solution include a queue and a count array. We'll give every passenger an index according to when they appear. For example, the first passenger of the first ship has the first index. The <var>#nation#</var> array will be used to keep their nationalities. The <var>#passenger#</var> array will keep the indexes of the first passengers of the ships. Its size is <var>(#n#+1)</var> since <var>#passenger#(_#n#+1_)</var> will be used to keep the next integer of the index of the last passenger of all. In this way, the indexes of passengers on the <var>#i#</var>-th arrived ship are from <var>#passenger#(_#i#_)</var> to <var>(#passenger#(_#i#+1_)-1)</var>. What's more, the <var>#time#</var> array keeps the arrival times of ships. The <var>#count#</var> array is used to keep the numbers of every nationality in the queue. And the queue, I think you have known the purpose, is used to keep the ships that arrived in 86400 seconds from the arrival of the last ship. </p>
			<p>When a new ship has arrived, keep the time of its arrival in the <var>#time#</var> array. Then add the number of the passengers into the <var>#passenger#</var> array and add the nationalities to the <var>#nation#</var> array and the <var>#count#</var> array. Then check if the head ship of the queue has been out of time. If it has, then remove the nationalities of the passengers on the head ship and check the next ship until the leaving time of the head ship is in the 86400 seconds. While adding nationalities, don't forget to refresh the answer when you found that <var>#count#(_#i#_)</var> equals zero. After everything has been done, output the answer and wait for the arrival of the next ship. </p>
		</section>
		<h3>Code</h3>
		<section>
			<p>Pascal</p>
			<code>
				var
				`nation:array[1..300000]of longint;
				`count,passenger:array[1..100001]of longint;
				`time:array[1..100000]of longint;
				`n,ans,queue,i,j:longint;
				begin
				`ans:=0;
				`queue:=1;
				`for i:=1 to 100001 do//Initialize the count array
				``count[i]:=0;
				`passenger[1]:=1;
				`read(n);
				`for i:=1 to n do
				``begin
				```read(time[i],passenger[i+1]);
				```passenger[i+1]:=passenger[i]+passenger[i+1];
				```for j:=passenger[i] to passenger[i+1]-1 do
				````begin
				`````read(nation[j]);
				`````if count[nation[j]]=0 then//If there was no one else with this nationality, refresh the answer
				``````inc(ans);
				`````inc(count[nation[j]]);
				````end;
				```while time[queue]+86400&lt;=time[i] do//Check whether the head ship is still in the interval
				````begin
				`````for j:=passenger[queue] to passenger[queue+1]-1 do
				``````begin
				```````dec(count[nation[j]]);
				```````if count[nation[j]]&lt;=0 then//If there was no one else with this nationality, refresh the answer
				````````dec(ans);
				``````end;
				`````inc(queue);
				````end;
				```writeln(ans);
				``end;
				end.
			</code>
			<p>C++</p>
			<code>
				#include&lt;cstdio&gt;
				long nation[300000],count[100001],time[100000],passenger[100001];//The nationalies are from 1 to 100000, so we need a count array with a size of 100001 since the array is started from 0 in C++
				int main()
				{
				`long n,ans=0,queue=0;
				`for(long i=0;i&lt;100001;i++)//Initialize the count array
				``count[i]=0;
				`passenger[0]=0;
				`scanf("%ld",&amp;n);
				`for(long i=0;i&lt;n;i++)
				`{
				``scanf("%ld%ld",&amp;time[i],&amp;passenger[i+1]);
				``passenger[i+1]+=passenger[i];
				``for(long j=passenger[i];j&lt;passenger[i+1];j++)
				``{
				```scanf("%ld",&amp;nation[j]);
				```if(count[nation[j]]==0)//If there was no one else with this nationality, refresh the answer
				````ans++;
				```count[nation[j]]++;
				``}
				``while(time[queue]+86400&lt;=time[i])//Check whether the head ship is still in the interval
				``{
				```for(long j=passenger[queue];j&lt;passenger[queue+1];j++)
				```{
				````count[nation[j]]--;
				````if(count[nation[j]]&lt;=0)//If there was no one else with this nationality, refresh the answer
				`````ans--;
				```}
				```queue++;
				``}
				``printf("%ld\n",ans);
				`}
				`return 0;
				}
			</code>
		</section>
		<script type="text/javascript" src="/add-on/article/article.js"></script>
		<script type="text/javascript" src="/add-on/highlight/highlight.js"></script>
		<script type="text/javascript" src="/add-on/math/math.js"></script>
	</body>
</html>
