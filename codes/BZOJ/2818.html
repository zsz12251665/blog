<h1>BZOJ 2818</h1>
<p><time>2020-01-28 20:17</time> by zsz12251665</p>
<section>
	<h2>Problem</h2>
	<ul class="buttonList">
		<a target="_blank" href="https://vjudge.net/problem/HYSBZ-2818"><li>Virtual Judge</li></a>
		<a target="_blank" href="https://www.lydsy.com/JudgeOnline/problem.php?id=2818"><li>BZOJ</li></a>
	</ul>
</section>
<section>
	<h2>Solution</h2>
	<p>This problem is about number theory. To solve this problem, we are going to need some knowledge about Dirichlet convolution and Mobius inversion. </p>
	<p>First of all, we have the original form of the answer. </p>
	<p style="text-align: center;"><data value="v{ans}o{=}o{&sum;}i{v{n}l{}v{x}o{=}c{1}}o{&sum;}i{v{n}l{}v{y}o{=}c{1}}o{[}o{&phi;}o{(}o{gcd}o{(}v{x}o{,}v{y}o{)}o{)}o{=}o{gcd}o{(}v{x}o{,}v{y}o{)}o{-}c{1}o{]}"></data></p>
	<p>Though this form is quite difficult to solve, we can try enumerate the prime which is probably the <abbr title="Greatest Common Divider">GCD</abbr> of the numbers. So we can transform it into the following form. </p>
	<p style="text-align: center;"><data value="v{ans}o{=}o{&sum;}b{v{p}o{:}c{prime}}o{&sum;}i{v{n}l{}v{x}o{=}c{1}}o{&sum;}i{v{n}l{}v{y}o{=}c{1}}o{[}o{gcd}o{(}v{x}o{,}v{y}o{)}o{=}v{p}o{]}"></data></p>
	<p>We assume that <data value="v{x}o{=}v{i}o{}v{p}o{,}v{y}o{=}v{j}o{}v{p}"></data> (otherwise they will make no contribution to the answer), then we have</p>
	<p style="text-align: center;"><data value="v{ans}o{=}o{&sum;}b{v{p}o{:}c{prime}}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{i}o{=}c{1}}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{j}o{=}c{1}}o{[}o{gcd}o{(}v{i}o{,}v{j}o{)}o{=}c{1}o{]}o{=}o{&sum;}b{v{p}o{:}c{prime}}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{i}o{=}c{1}}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{j}o{=}c{1}}o{e}o{(}o{gcd}o{(}v{i}o{,}v{j}o{)}o{)}"></data></p>
	<p>Now it is time to use the Mobius inversion. Because <data value="o{e}o{=}o{&mu;}o{&midast;}o{1}"></data>, so</p>
	<p style="text-align: center;"><data value="v{ans}o{=}o{&sum;}b{v{p}o{:}c{prime}}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{i}o{=}c{1}}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{j}o{=}c{1}}o{&sum;}b{v{d}o{|}o{gcd}o{(}v{i}o{,}v{j}o{)}}o{(}o{&mu;}o{(}v{d}o{)}o{}o{1}o{(}f{o{gcd}o{(}v{i}o{,}v{j}o{)}l{}v{d}}o{)}o{)}o{=}o{&sum;}b{v{p}o{:}c{prime}}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{i}o{=}c{1}}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{j}o{=}c{1}}o{&sum;}b{v{d}o{|}o{gcd}o{(}v{i}o{,}v{j}o{)}}o{&mu;}o{(}v{d}o{)}"></data></p>
	<p>After that, we change the order of the sum, put <data value="v{d}"></data> after <data value="v{p}"></data>, then</p>
	<p style="text-align: center;"><data value="v{ans}o{=}o{&sum;}b{v{p}o{:}c{prime}}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{d}o{=}c{1}}o{(}o{&mu;}o{(}v{d}o{)}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{i}o{=}c{1}}o{[}v{d}o{|}v{i}o{]}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{j}o{=}c{1}}o{[}v{d}o{|}v{j}o{]}o{)}o{=}o{&sum;}b{v{p}o{:}c{prime}}o{&sum;}i{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{d}o{=}c{1}}o{(}o{&mu;}o{(}v{d}o{)}o{&lfloor;}f{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{d}}o{&rfloor;}p{c{2}}o{)}"></data></p>
	<p>Now we can enumerate <data value="v{p}"></data> and <data value="o{&lfloor;}f{o{&lfloor;}f{v{n}l{}v{p}}o{&rfloor;}l{}v{d}}o{&rfloor;}"></data> to calculate the answer in <data value="o{O}o{(}o{&pi;}o{(}v{n}o{)}o{}o{&Sqrt;}t{v{n}}o{)}"></data> which <data value="o{&pi;}o{(}v{n}o{)}"></data> is the number of prime numbers in <data value="o{[}c{1}o{,}v{n}o{]}"></data> plus the <data value="o{O}o{(}v{n}o{)}"></data> preprocess of the prime numbers and the prefix sum of the <data value="o{&mu;}o{(}v{n}o{)}"></data>. According to the prime number theorem, <data value="o{O}o{(}o{&pi;}o{(}v{n}o{)}o{)}o{=}o{O}o{(}f{v{n}l{}o{ln}v{n}}o{)}"></data>, so the total time complexity should be around <data value="o{O}o{(}f{v{n}o{}o{&Sqrt;}t{v{n}}l{}o{ln}v{n}}o{)}"></data>, which just might be available due to the time limit of 10 seconds. </p>
</section>
<section>
	<h2>Code</h2>
	<section>
		<h3>Pascal</h3>
		<code lang="pas"></code>
	</section>
	<section>
		<h3>C++</h3>
		<code lang="cpp"></code>
	</section>
</section>
