<h2>POJ 3070</h2>
<time>2017-12-28 16:20 by zsz12251665</time>
<h3>Problem</h3>
<section class="buttonField">
	<a target="_blank" href="https://vjudge.net/problem/POJ-3070">vjudge</a>
	<a target="_blank" href="http://poj.org/problem?id=3070">POJ</a>
</section>
<h3>Solution</h3>
<section>
	<p>The method of calculating the <data value="v{n}"></data>-th number of the Fibonacci integer sequence has been given in the description of the problem. It is the power of matrix. But since <data value="c{0}o{&le;}v{n}o{&le;}c{10}p{9}"></data>, we need a fast power of matrix, which is like the fast power of integer of which time complexity is <data value="o{O}o{(}o{lg}v{n}o{)}"></data>. </p>
	<p>For the beginners who don't know how the multiplication of matrix is calculated, here it is. For two matrices <data value="o{[}i{v{a}b{1}l{}v{a}b{3}}o{&nbsp;}i{v{a}b{2}l{}v{a}b{4}}o{]}"></data> and <data value="o{[}i{v{b}b{1}l{}v{b}b{3}}o{&nbsp;}i{v{b}b{2}l{}v{b}b{4}}o{]}"></data>, the product is <data value="o{[}i{v{a}b{1}o{}v{b}b{1}o{+}v{a}b{2}o{}v{b}b{3}l{}v{a}b{3}o{}v{b}b{1}o{+}v{a}b{4}o{}v{b}b{3}}o{&nbsp;}i{v{a}b{1}o{}v{b}b{2}o{+}v{a}b{2}o{}v{b}b{4}l{}v{a}b{3}o{}v{b}b{2}o{+}v{a}b{4}o{}v{b}b{4}}o{]}"></data>. Although it doesn't have the commutative property, the multiplication of matrix has the associative property, which means <data value="o{(}o{[}i{v{a}b{1}l{}v{a}b{3}}o{&nbsp;}i{v{a}b{2}l{}v{a}b{4}}o{]}o{&times;}o{[}i{v{b}b{1}l{}v{b}b{3}}o{&nbsp;}i{v{b}b{2}l{}v{b}b{4}}o{]}o{)}o{&times;}o{[}i{v{c}b{1}l{}v{c}b{3}}o{&nbsp;}i{v{c}b{2}l{}v{c}b{4}}o{]}o{=}o{[}i{v{a}b{1}l{}v{a}b{3}}o{&nbsp;}i{v{a}b{2}l{}v{a}b{4}}o{]}o{&times;}o{(}o{[}i{v{b}b{1}l{}v{b}b{3}}o{&nbsp;}i{v{b}b{2}l{}v{b}b{4}}o{]}o{&times;}o{[}i{v{c}b{1}l{}v{c}b{3}}o{&nbsp;}i{v{c}b{2}l{}v{c}b{4}}o{]}o{)}"></data>. So we can make the fast power of matrix as same as the fast power of integer which transforms the index into binary. </p>
</section>
<h3>Code</h3>
<section>
	<p>Pascal</p>
	<code lang="pas"></code>
	<p>C++</p>
	<code lang="cpp"></code>
</section>
